
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://ttran0.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Truong's Website Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />


<meta name="author" content="Truong Tran" />
<meta name="description" content="Multilayer Perceptron¶ So I recently upgraded my desktop and now that I have a gtx 1070 card, I really wanted to get my hands on deep learning using my gpu. The library that I have decided to go with is Tensorflow. Tensorflow is a graph computation/deep learning library developed by Google. Tensorflow also has support for running on the gpu so that we can train larger and faster networks. This notebook will run through will include building a multilayer perceptron model on the classic MNIST dataset." />
<meta name="keywords" content="python">
<meta property="og:site_name" content="Truong's Website"/>
<meta property="og:title" content="Hello World! (Of Tensorflow, GPU Computing, and Deep Learning)"/>
<meta property="og:description" content="Multilayer Perceptron¶ So I recently upgraded my desktop and now that I have a gtx 1070 card, I really wanted to get my hands on deep learning using my gpu. The library that I have decided to go with is Tensorflow. Tensorflow is a graph computation/deep learning library developed by Google. Tensorflow also has support for running on the gpu so that we can train larger and faster networks. This notebook will run through will include building a multilayer perceptron model on the classic MNIST dataset."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ttran0.github.io/Deep-Learning.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-02-16 20:11:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ttran0.github.io/author/truong-tran.html">
<meta property="article:section" content="Projects"/>
<meta property="article:tag" content="python"/>
<meta property="og:image" content="https://media.licdn.com/mpr/mpr/shrinknp_400_400/AAEAAQAAAAAAAAlNAAAAJDUwZmRlZmQ1LWRkYmMtNDA0OC1hMzVkLTQ0NmEzN2E4MjI4MA.jpg">

  <title>Truong's Website &ndash; Hello World! (Of Tensorflow, GPU Computing, and Deep Learning)</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://ttran0.github.io">
        <img src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/AAEAAQAAAAAAAAlNAAAAJDUwZmRlZmQ1LWRkYmMtNDA0OC1hMzVkLTQ0NmEzN2E4MjI4MA.jpg" alt="" title="">
      </a>
      <h1><a href="https://ttran0.github.io"></a></h1>

<p>Mathematician & Data Science Practitioner</p>
      <nav>
        <ul class="list">
          <li><a href="https://ttran0.github.io/pages/about-me.html#about-me">About Me</a></li>
          <li><a href="https://ttran0.github.io/pages/contact.html#contact">Contact</a></li>
          <li><a href="https://ttran0.github.io/pages/resume.html#resume">Resume</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/truong-tran" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/ttran0" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://ttran0.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/category/projects.html">Data Science Projects</a>
      <a href="/category/teaching.html">Teaching</a>

      <a href="https://ttran0.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="Deep-Learning">Hello World! (Of Tensorflow, GPU Computing, and Deep Learning)</h1>
    <p>
          Posted on Thu 16 February 2017 in <a href="https://ttran0.github.io/category/projects.html">Projects</a>


    </p>
  </header>


  <div>
    <style type="text/css">/*!
*
* IPython notebook
*
*/.ansibold{font-weight:700}.ansiblack{}.ansired{color:#8b0000}.ansigreen{6400}.ansiyellow{color:#c4a000}.ansiblue{8b}.ansipurple{color:#9400d3}.ansicyan{color:#4682b4}.ansigray{color:gray}.ansibgblack{background-}.ansibgred{background-color:red}.ansibggreen{background-color:green}.ansibgyellow{background-color:#ff0}.ansibgblue{background-f}.ansibgpurple{background-color:#ff00ff}.ansibgcyan{background-ff}.ansibggray{background-color:gray}div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;border-width:thin;border-style:solid;width:100%;padding:5px;margin:0;outline:0}div.cell.selected{border-color:#ababab}@media print{div.cell.selected{border-color:transparent}}.edit_mode div.cell.selected{border-color:green}.prompt{min-width:14ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}@-moz-document url-prefix(){div.inner_cell{overflow-x:hidden}}div.input_area{border:1px solid #cfcfcf;border-radius:2px;background:#f7f7f7;line-height:1.21429em}div.prompt:empty{padding-top:0;padding-bottom:0}div.unrecognized_cell{padding:5px 5px 5px 0;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.unrecognized_cell .inner_cell{border-radius:2px;padding:5px;font-weight:700;color:red;border:1px solid #cfcfcf;background:#eaeaea}div.unrecognized_cell .inner_cell a,div.unrecognized_cell .inner_cell a:hover{color:inherit;text-decoration:none}@media (max-width:540px){.prompt{text-align:left}div.unrecognized_cell>div.prompt{display:none}}div.code_cell{}div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.input{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.input_prompt{color:navy;border-top:1px solid transparent}div.input_area>div.highlight{margin:.4em;border:none;padding:0;background-color:transparent}div.input_area>div.highlight>pre{margin:0;border:none;padding:0;background-color:transparent}.CodeMirror{line-height:1.21429em;font-size:14px;height:auto;background:0 0}.CodeMirror-scroll{overflow-y:hidden;overflow-x:auto}.CodeMirror-lines{padding:.4em}.CodeMirror-linenumber{padding:0 8px 0 4px}.CodeMirror-gutters{border-bottom-left-radius:2px;border-top-left-radius:2px}.CodeMirror pre{padding:0;border:0;border-radius:0}.highlight-base,.highlight-variable{}.highlight-variable-2{color:#1a1a1a}.highlight-variable-3{color:#333}.highlight-string{color:#BA2121}.highlight-comment{color:#408080;font-style:italic}.highlight-number{80}.highlight-atom{color:#88F}.highlight-keyword{color:green;font-weight:700}.highlight-builtin{color:green}.highlight-error{color:red}.highlight-operator{color:#A2F;font-weight:700}.highlight-meta{color:#A2F}.highlight-def{f}.highlight-string-2{color:#f50}.highlight-qualifier{color:#555}.highlight-bracket{color:#997}.highlight-tag{color:#170}.highlight-attribute{c}.highlight-header{f}.highlight-quote{90}.highlight-link{c}.cm-s-ipython span.cm-keyword{color:green;font-weight:700}.cm-s-ipython span.cm-atom{color:#88F}.cm-s-ipython span.cm-number{80}.cm-s-ipython span.cm-def{f}.cm-s-ipython span.cm-variable{}.cm-s-ipython span.cm-operator{color:#A2F;font-weight:700}.cm-s-ipython span.cm-variable-2{color:#1a1a1a}.cm-s-ipython span.cm-variable-3{color:#333}.cm-s-ipython span.cm-comment{color:#408080;font-style:italic}.cm-s-ipython span.cm-string{color:#BA2121}.cm-s-ipython span.cm-string-2{color:#f50}.cm-s-ipython span.cm-meta{color:#A2F}.cm-s-ipython span.cm-qualifier{color:#555}.cm-s-ipython span.cm-builtin{color:green}.cm-s-ipython span.cm-bracket{color:#997}.cm-s-ipython span.cm-tag{color:#170}.cm-s-ipython span.cm-attribute{c}.cm-s-ipython span.cm-header{f}.cm-s-ipython span.cm-quote{90}.cm-s-ipython span.cm-link{c}.cm-s-ipython span.cm-error{color:red}.cm-s-ipython span.cm-tab{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=')right no-repeat}div.output_wrapper{display:-webkit-box;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;z-index:1}div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:2px;-webkit-box-shadow:inset 0 2px 8px rgba(0,0,0,.8);box-shadow:inset 0 2px 8px rgba(0,0,0,.8);display:block}div.output_collapsed{margin:0;padding:0;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.out_prompt_overlay{height:100%;padding:0 .4em;position:absolute;border-radius:2px}div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000;box-shadow:inset 0 0 1px #000;background:rgba(240,240,240,.5)}div.output_prompt{color:#8b0000}div.output_area{padding:0;page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.output_area .MathJax_Display{text-align:left!important}div.output_area div.output_area img,div.output_area svg{max-width:100%;height:auto}div.output_area img.unconfined,div.output_area svg.unconfined{max-width:none}.output{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}@media (max-width:540px){div.output_area{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.output_area pre{margin:0;padding:0;border:0;vertical-align:baseline;background-color:transparent;border-radius:0}div.output_subarea{overflow-x:auto;padding:.4em;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;max-width:calc(100% - 14ex)}div.output_text{text-align:left;line-height:1.21429em}div.output_stderr{background:#fdd}div.output_latex{text-align:left}div.output_javascript:empty{padding:0}.js-error{color:#8b0000}div.raw_input_container{font-family:monospace;padding-top:5px}span.raw_input_prompt{}input.raw_input{font-family:inherit;font-size:inherit;color:inherit;width:auto;vertical-align:baseline;padding:0 .25em;margin:0 .25em}input.raw_input:focus{box-shadow:none}p.p-space{margin-bottom:10px}div.output_unrecognized{padding:5px;font-weight:700;color:red}div.output_unrecognized a,div.output_unrecognized a:hover{color:inherit;text-decoration:none}.rendered_html{}.rendered_html :link,.rendered_html :visited,.rendered_html h1:first-child{margin-top:.538em}.rendered_html h2:first-child{margin-top:.636em}.rendered_html h3:first-child{margin-top:.777em}.rendered_html h4:first-child,.rendered_html h5:first-child,.rendered_html h6:first-child{margin-top:1em}.rendered_html *+ol,.rendered_html *+ul{margin-top:1em}.rendered_html *+table{margin-top:1em}.rendered_html *+p{margin-top:1em}.rendered_html *+img{margin-top:1em}div.text_cell{display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.text_cell>div.prompt{display:none}}div.text_cell_render{outline:0;resize:none;width:inherit;border-style:none;padding:.5em .5em .5em .4em;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}a.anchor-link:link{text-decoration:none;padding:0 20px;visibility:hidden}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible}.text_cell.rendered .input_area{display:none}.text_cell.rendered .text_cell.unrendered .text_cell_render{display:none}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6{font-weight:700;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cm-header-1{font-size:185.7%}.cm-header-2{font-size:157.1%}.cm-header-3{font-size:128.6%}.cm-header-4{font-size:110%}.cm-header-5,.cm-header-6{font-size:100%;font-style:italic}</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multilayer-Perceptron">Multilayer Perceptron<a class="anchor-link" href="#Multilayer-Perceptron">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So I recently upgraded my desktop and now that I have a gtx 1070 card, I really wanted to get my hands on deep learning using my gpu. The library that I have decided to go with is Tensorflow. Tensorflow is a graph computation/deep learning library developed by Google. Tensorflow also has support for running on the gpu so that we can train larger and faster networks. This notebook will run through will include building a multilayer perceptron model on the classic MNIST dataset.</p>
<p>The MNIST dataset includes samples of handwritten digits from 1 - 10. The objective is to train our network so that it can determine the digit in a given image.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="k">import</span> <span class="n">input_data</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="s2">"/tmp/data/"</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Extracting /tmp/data/train-images-idx3-ubyte.gz
Extracting /tmp/data/train-labels-idx1-ubyte.gz
Extracting /tmp/data/t10k-images-idx3-ubyte.gz
Extracting /tmp/data/t10k-labels-idx1-ubyte.gz
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some examples of what each image looks like in the MNIST dataset:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[4]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.image.axesimage at 0x12a38cb70></pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
AvYAAAAASUVORK5CYII=
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[5]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.image.axesimage at 0x12a579cf8></pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
9mhW+7a7/1Pz2gPQLFXD7+7Dkoaz1wfNbIekM5vdGIDmekfv+c2sR9J8SU9mk24ws61mttrMTs9Z
pt/MBs1scFSHGmoWQHFqDr+ZzZD0Q0k3uvsBSasknStpnipnBt+aaDl3H3D3Xnfv7VD6/SOA1qkp
/GbWoUrwv+/uD0mSu+9x9yPuflTS3ZIWNK9NAEWrGn4zM0n3SNrh7rePm949brbPSNpefHsAmqWW
T/svlnSNpG1mtiWbtlLScjObp8rlvyFJX2xKhyjXUU+Wv/fwpcn6Iz9fmFs7+wc/q6cjFKSWT/t/
KskmKHFNH5jE+IYfEBThB4Ii/EBQhB8IivADQRF+ICge3Y0kH82/JVeSer7GbbeTFUd+ICjCDwRF
+IGgCD8QFOEHgiL8QFCEHwjK3NP3axe6MbPXJL08btIZkl5vWQPvTLv21q59SfRWryJ7e5+7/14t
M7Y0/G/buNmgu/eW1kBCu/bWrn1J9FavsnrjtB8IivADQZUd/oGSt5/Srr21a18SvdWrlN5Kfc8P
oDxlH/kBlKSU8JvZFWb2CzN70cxuLqOHPGY2ZGbbzGyLmQ2W3MtqMxsxs+3jps02s0fN7IXs94TD
pJXU2y1mtivbd1vMbHFJvc0xs/82s2fN7Bkz+5tseqn7LtFXKfut5af9ZjZF0vOSLpO0U9ImScvd
/dmWNpLDzIYk9bp76deEzeyPJL0h6V53Pz+bdpukfe5+a/YP5+nu/rdt0tstkt4oe+TmbECZ7vEj
S0u6StJfqcR9l+hrqUrYb2Uc+RdIetHdX3L3w5IekLSkhD7anrs/LmnfcZOXSFqTvV6jyv88LZfT
W1tw92F3fzp7fVDSsZGlS913ib5KUUb4z5T06ri/d6q9hvx2SY+Z2WYz6y+7mQl0ZcOmS9JuSV1l
NjOBqiM3t9JxI0u3zb6rZ8TrovGB39td4u7zJH1K0vXZ6W1b8sp7tna6XFPTyM2tMsHI0r9T5r6r
d8TropUR/l2S5oz7+6xsWltw913Z7xFJa9V+ow/vOTZIavZ7pOR+fqedRm6eaGRptcG+a6cRr8sI
/yZJc83sHDObKmmZpPUl9PE2ZjY9+yBGZjZd0uVqv9GH10vqy173SVpXYi9v0S4jN+eNLK2S913b
jXjt7i3/kbRYlU/8fynpa2X0kNPXuZJ+nv08U3Zvku5X5TRwVJXPRlZIerekjZJekPSYpNlt1Nv3
JG2TtFWVoHWX1NslqpzSb5W0JftZXPa+S/RVyn7jG35AUHzgBwRF+IGgCD8QFOEHgiL8QFCEHwiK
8ANBEX4gqP8HdDtbXOQ5PmoAAAAASUVORK5CYII=
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A multilayer perceptron model consists of an input layer, a hidden layer (or multiple hidden layers), and an output layer.</p>
<p><img alt="title" src="http://www.texample.net/media/tikz/examples/PNG/neural-network.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our model will contain 3 hidden layers with the rectified linear unit (ReLU) function as our activation function. The ReLU function is defined as:
$$
f(x) = 
\begin{cases} 
      1 & x > 0 \\
      0 & otherwise
   \end{cases}
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s2">"float"</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s2">"float"</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define model:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mlp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">):</span>
    <span class="c1"># Hidden Layer 1</span>
    <span class="n">layer1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'h1'</span><span class="p">]),</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'b1'</span><span class="p">])</span>
    <span class="n">layer1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer1</span><span class="p">)</span>
    
    <span class="c1"># Hidden Layer 2 </span>
    <span class="n">layer2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">layer1</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'h2'</span><span class="p">]),</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'b2'</span><span class="p">])</span>
    <span class="n">layer2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer2</span><span class="p">)</span>
    
    <span class="c1"># Hidden Layer 3 </span>
    <span class="n">layer3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">layer2</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'h3'</span><span class="p">]),</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'b3'</span><span class="p">])</span>
    <span class="n">layer3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer3</span><span class="p">)</span>
    
    <span class="c1"># Output Layer </span>
    <span class="n">output_layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">layer3</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'out'</span><span class="p">])</span> <span class="o">+</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'out'</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">output_layer</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define our weights and biases:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Define weights and biases</span>
<span class="n">n_hidden1</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">n_hidden2</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">n_hidden3</span> <span class="o">=</span> <span class="mi">256</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'h1'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">n_hidden1</span><span class="p">])),</span> 
    <span class="s1">'h2'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden1</span><span class="p">,</span> <span class="n">n_hidden2</span><span class="p">])),</span>
    <span class="s1">'h3'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden2</span><span class="p">,</span> <span class="n">n_hidden3</span><span class="p">])),</span>
    <span class="s1">'out'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden3</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">]))</span>
<span class="p">}</span>

<span class="n">biases</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'b1'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden1</span><span class="p">])),</span> 
    <span class="s1">'b2'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden2</span><span class="p">])),</span> 
    <span class="s1">'b3'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden3</span><span class="p">])),</span>
    <span class="s1">'out'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">num_classes</span><span class="p">]))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">training_epochs</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">biases</span><span class="p">)</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax_cross_entropy_with_logits</span><span class="p">(</span><span class="n">logits</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">y</span><span class="p">))</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use the stochastic gradient adam optimization algorithm to optimize our weights and biases with batch size 100. The stochastic gradient descent will randomly sample 100 of the images in our training set and train our model using 50 epochs to update our weights (1 pass forward in the network, and 1 pass backwards using backpropagation). The data has already been split into a training and testing set as part of a built in feature in Tensorflow. We just need to train our model and determine its accuracy by comparing it to the test set.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>

<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

    
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">training_epochs</span><span class="p">):</span>
        <span class="n">avg_cost</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">total_batch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">num_examples</span><span class="o">/</span><span class="n">batch_size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_batch</span><span class="p">):</span>
            
            <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
                        
            <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">cost</span><span class="p">],</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">batch_x</span><span class="p">,</span>
                                                          <span class="n">y</span><span class="p">:</span> <span class="n">batch_y</span><span class="p">})</span>
            
            <span class="n">avg_cost</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">total_batch</span>

        <span class="nb">print</span> <span class="p">(</span><span class="s2">"Epoch:"</span><span class="p">,</span> <span class="s1">'</span><span class="si">%0d</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s2">"cost="</span><span class="p">,</span> <span class="s2">"</span><span class="si">{:.3f}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avg_cost</span><span class="p">))</span>

    
    <span class="n">pred</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="s2">"float"</span><span class="p">))</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s2">"Accuracy:"</span><span class="p">,</span> <span class="n">acc</span><span class="o">.</span><span class="n">eval</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">images</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">labels</span><span class="p">})</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch: 1 cost= 678.088
Epoch: 2 cost= 100.495
Epoch: 3 cost= 50.950
Epoch: 4 cost= 33.545
Epoch: 5 cost= 22.439
Epoch: 6 cost= 14.376
Epoch: 7 cost= 12.968
Epoch: 8 cost= 12.089
Epoch: 9 cost= 11.579
Epoch: 10 cost= 10.635
Epoch: 11 cost= 11.402
Epoch: 12 cost= 12.854
Epoch: 13 cost= 12.214
Epoch: 14 cost= 10.492
Epoch: 15 cost= 9.614
Epoch: 16 cost= 9.490
Epoch: 17 cost= 9.889
Epoch: 18 cost= 10.120
Epoch: 19 cost= 9.650
Epoch: 20 cost= 9.716
Epoch: 21 cost= 7.642
Epoch: 22 cost= 8.516
Epoch: 23 cost= 8.134
Epoch: 24 cost= 7.146
Epoch: 25 cost= 6.589
Accuracy: 96.749997139
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With 50 epochs, a 3 hidden layer multilayer perceptron optimized with the adam optimizer, we achieve a 96.7% accuracy. This accuracy is actually not that great compared to what other models can do. One way to improve on this model is introduce convolution and pooling layers, more commonly known as a convolutional neural network, which is what I will be working on next to get a better accuracy.</p>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ttran0.github.io/tag/python.html">python</a>
    </p>
  </div>


    <div class="addthis_relatedposts_inline">


</article>

    <footer>
<p>&copy; Truong Tran </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Truong's Website ",
  "url" : "https://ttran0.github.io",
  "image": "https://media.licdn.com/mpr/mpr/shrinknp_400_400/AAEAAQAAAAAAAAlNAAAAJDUwZmRlZmQ1LWRkYmMtNDA0OC1hMzVkLTQ0NmEzN2E4MjI4MA.jpg",
  "description": ""
}
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://ttran0.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Truong's Website Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />


<meta name="author" content="Truong Tran" />
<meta name="description" content="In my last notebook, I used a multilayer perceptron network (MLP) for classification using the MNIST dataset. For this notebook, I will apply a Convolutional Neural Network to the same dataset and see how this network performs| compared to the MLP." />
<meta name="keywords" content="python">
<meta property="og:site_name" content="Truong's Website"/>
<meta property="og:title" content="Convolutional Neural Network with Tensorflow + GPU"/>
<meta property="og:description" content="In my last notebook, I used a multilayer perceptron network (MLP) for classification using the MNIST dataset. For this notebook, I will apply a Convolutional Neural Network to the same dataset and see how this network performs| compared to the MLP."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ttran0.github.io/CNN-Tensorflow.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-02-23 21:54:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ttran0.github.io/author/truong-tran.html">
<meta property="article:section" content="Projects"/>
<meta property="article:tag" content="python"/>
<meta property="og:image" content="https://media.licdn.com/dms/image/C5103AQE-KW5gH0banw/profile-displayphoto-shrink_200_200/0?e=1529121600&v=beta&t=t7WWD9umuS0wPmwZbYJQBMajMvCBZHHWEbQuy67A_1M">

  <title>Truong's Website &ndash; Convolutional Neural Network with Tensorflow + GPU</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://ttran0.github.io">
        <img src="https://media.licdn.com/dms/image/C5103AQE-KW5gH0banw/profile-displayphoto-shrink_200_200/0?e=1529121600&v=beta&t=t7WWD9umuS0wPmwZbYJQBMajMvCBZHHWEbQuy67A_1M" alt="" title="">
      </a>
      <h1><a href="https://ttran0.github.io"></a></h1>

<p>Mathematician & Data Science Practitioner</p>
      <nav>
        <ul class="list">
          <li><a href="https://ttran0.github.io/pages/about-me.html#about-me">About Me</a></li>
          <li><a href="https://ttran0.github.io/pages/contact.html#contact">Contact</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/truong-tran" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/ttran0" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://ttran0.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/category/projects.html">Data Science Projects</a>
      <a href="/category/teaching.html">Teaching</a>

      <a href="https://ttran0.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="CNN-Tensorflow">Convolutional Neural Network with Tensorflow + GPU</h1>
    <p>
          Posted on Thu 23 February 2017 in <a href="https://ttran0.github.io/category/projects.html">Projects</a>


    </p>
  </header>


  <div>
    <style type="text/css">/*!
*
* IPython notebook
*
*/.ansibold{font-weight:700}.ansiblack{}.ansired{color:#8b0000}.ansigreen{6400}.ansiyellow{color:#c4a000}.ansiblue{8b}.ansipurple{color:#9400d3}.ansicyan{color:#4682b4}.ansigray{color:gray}.ansibgblack{background-}.ansibgred{background-color:red}.ansibggreen{background-color:green}.ansibgyellow{background-color:#ff0}.ansibgblue{background-f}.ansibgpurple{background-color:#ff00ff}.ansibgcyan{background-ff}.ansibggray{background-color:gray}div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;border-width:thin;border-style:solid;width:100%;padding:5px;margin:0;outline:0}div.cell.selected{border-color:#ababab}@media print{div.cell.selected{border-color:transparent}}.edit_mode div.cell.selected{border-color:green}.prompt{min-width:14ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}@-moz-document url-prefix(){div.inner_cell{overflow-x:hidden}}div.input_area{border:1px solid #cfcfcf;border-radius:2px;background:#f7f7f7;line-height:1.21429em}div.prompt:empty{padding-top:0;padding-bottom:0}div.unrecognized_cell{padding:5px 5px 5px 0;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.unrecognized_cell .inner_cell{border-radius:2px;padding:5px;font-weight:700;color:red;border:1px solid #cfcfcf;background:#eaeaea}div.unrecognized_cell .inner_cell a,div.unrecognized_cell .inner_cell a:hover{color:inherit;text-decoration:none}@media (max-width:540px){.prompt{text-align:left}div.unrecognized_cell>div.prompt{display:none}}div.code_cell{}div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.input{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.input_prompt{color:navy;border-top:1px solid transparent}div.input_area>div.highlight{margin:.4em;border:none;padding:0;background-color:transparent}div.input_area>div.highlight>pre{margin:0;border:none;padding:0;background-color:transparent}.CodeMirror{line-height:1.21429em;font-size:14px;height:auto;background:0 0}.CodeMirror-scroll{overflow-y:hidden;overflow-x:auto}.CodeMirror-lines{padding:.4em}.CodeMirror-linenumber{padding:0 8px 0 4px}.CodeMirror-gutters{border-bottom-left-radius:2px;border-top-left-radius:2px}.CodeMirror pre{padding:0;border:0;border-radius:0}.highlight-base,.highlight-variable{}.highlight-variable-2{color:#1a1a1a}.highlight-variable-3{color:#333}.highlight-string{color:#BA2121}.highlight-comment{color:#408080;font-style:italic}.highlight-number{80}.highlight-atom{color:#88F}.highlight-keyword{color:green;font-weight:700}.highlight-builtin{color:green}.highlight-error{color:red}.highlight-operator{color:#A2F;font-weight:700}.highlight-meta{color:#A2F}.highlight-def{f}.highlight-string-2{color:#f50}.highlight-qualifier{color:#555}.highlight-bracket{color:#997}.highlight-tag{color:#170}.highlight-attribute{c}.highlight-header{f}.highlight-quote{90}.highlight-link{c}.cm-s-ipython span.cm-keyword{color:green;font-weight:700}.cm-s-ipython span.cm-atom{color:#88F}.cm-s-ipython span.cm-number{80}.cm-s-ipython span.cm-def{f}.cm-s-ipython span.cm-variable{}.cm-s-ipython span.cm-operator{color:#A2F;font-weight:700}.cm-s-ipython span.cm-variable-2{color:#1a1a1a}.cm-s-ipython span.cm-variable-3{color:#333}.cm-s-ipython span.cm-comment{color:#408080;font-style:italic}.cm-s-ipython span.cm-string{color:#BA2121}.cm-s-ipython span.cm-string-2{color:#f50}.cm-s-ipython span.cm-meta{color:#A2F}.cm-s-ipython span.cm-qualifier{color:#555}.cm-s-ipython span.cm-builtin{color:green}.cm-s-ipython span.cm-bracket{color:#997}.cm-s-ipython span.cm-tag{color:#170}.cm-s-ipython span.cm-attribute{c}.cm-s-ipython span.cm-header{f}.cm-s-ipython span.cm-quote{90}.cm-s-ipython span.cm-link{c}.cm-s-ipython span.cm-error{color:red}.cm-s-ipython span.cm-tab{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=')right no-repeat}div.output_wrapper{display:-webkit-box;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;z-index:1}div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:2px;-webkit-box-shadow:inset 0 2px 8px rgba(0,0,0,.8);box-shadow:inset 0 2px 8px rgba(0,0,0,.8);display:block}div.output_collapsed{margin:0;padding:0;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.out_prompt_overlay{height:100%;padding:0 .4em;position:absolute;border-radius:2px}div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000;box-shadow:inset 0 0 1px #000;background:rgba(240,240,240,.5)}div.output_prompt{color:#8b0000}div.output_area{padding:0;page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.output_area .MathJax_Display{text-align:left!important}div.output_area div.output_area img,div.output_area svg{max-width:100%;height:auto}div.output_area img.unconfined,div.output_area svg.unconfined{max-width:none}.output{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}@media (max-width:540px){div.output_area{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.output_area pre{margin:0;padding:0;border:0;vertical-align:baseline;background-color:transparent;border-radius:0}div.output_subarea{overflow-x:auto;padding:.4em;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;max-width:calc(100% - 14ex)}div.output_text{text-align:left;line-height:1.21429em}div.output_stderr{background:#fdd}div.output_latex{text-align:left}div.output_javascript:empty{padding:0}.js-error{color:#8b0000}div.raw_input_container{font-family:monospace;padding-top:5px}span.raw_input_prompt{}input.raw_input{font-family:inherit;font-size:inherit;color:inherit;width:auto;vertical-align:baseline;padding:0 .25em;margin:0 .25em}input.raw_input:focus{box-shadow:none}p.p-space{margin-bottom:10px}div.output_unrecognized{padding:5px;font-weight:700;color:red}div.output_unrecognized a,div.output_unrecognized a:hover{color:inherit;text-decoration:none}.rendered_html{}.rendered_html :link,.rendered_html :visited,.rendered_html h1:first-child{margin-top:.538em}.rendered_html h2:first-child{margin-top:.636em}.rendered_html h3:first-child{margin-top:.777em}.rendered_html h4:first-child,.rendered_html h5:first-child,.rendered_html h6:first-child{margin-top:1em}.rendered_html *+ol,.rendered_html *+ul{margin-top:1em}.rendered_html *+table{margin-top:1em}.rendered_html *+p{margin-top:1em}.rendered_html *+img{margin-top:1em}div.text_cell{display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.text_cell>div.prompt{display:none}}div.text_cell_render{outline:0;resize:none;width:inherit;border-style:none;padding:.5em .5em .5em .4em;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}a.anchor-link:link{text-decoration:none;padding:0 20px;visibility:hidden}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible}.text_cell.rendered .input_area{display:none}.text_cell.rendered .text_cell.unrendered .text_cell_render{display:none}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6{font-weight:700;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cm-header-1{font-size:185.7%}.cm-header-2{font-size:157.1%}.cm-header-3{font-size:128.6%}.cm-header-4{font-size:110%}.cm-header-5,.cm-header-6{font-size:100%;font-style:italic}</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In my last notebook, I used a multilayer perceptron network (MLP) for classification using the MNIST dataset. For this notebook, I will apply a Convolutional Neural Network to the same dataset and see how this network performs| compared to the MLP.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="k">import</span> <span class="n">imread</span><span class="p">,</span> <span class="n">imresize</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="k">import</span> <span class="n">input_data</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="s2">"/tmp/data/"</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Extracting /tmp/data/train-images-idx3-ubyte.gz
Extracting /tmp/data/train-labels-idx1-ubyte.gz
Extracting /tmp/data/t10k-images-idx3-ubyte.gz
Extracting /tmp/data/t10k-labels-idx1-ubyte.gz
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">10</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[4]:</div>
<div class="output_text output_subarea output_execute_result">
<pre>(10, 784)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data">Data<a class="anchor-link" href="#Data">¶</a></h3><p>We will be using the MNIST dataset. This dataset contains handwritten digits ranging from 0 - 9. Each image is 28x28 in resolution. Some examples of images in our set:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[25]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.image.axesimage at 0x1bee42c9fd0></pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
E8G4AAAAAElFTkSuQmCC
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[26]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.image.axesimage at 0x1bee432f828></pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Convolutional-Neural-Network-Model-(CNN)">Convolutional Neural Network Model (CNN)<a class="anchor-link" href="#Convolutional-Neural-Network-Model-(CNN)">¶</a></h3><p>The CNN is similar to the multilayer percepton model we previously did with an addition of two types of layers: the convolution layer and the pooling layer.</p>
<p><strong> Convolution Layer</strong> :
Given an image, the convolution layer consists of a matrix (filter), often a matrix smaller than the image, that is multiplied element wise with the image matrix in strides. With each stride, the element wise multiplication is then summed and stored into a new matrix. For example, lets consider the image matrix</p>
\begin{bmatrix}
1 & 1 & 1 & 0 & 0 \\
0 & 1 & 1 & 1 & 0 \\
0 & 0 & 1 & 1 & 1 \\
0 & 0 & 1 & 1 & 0 \\
0 & 1 & 1 & 0 & 0
\end{bmatrix}$$
\text{Image}
$$<p>and we apply this filter matrix to the image with a stride of 1.</p>
\begin{bmatrix}
1 & 0 & 1 \\
0 & 1 & 0 \\
1 & 0 & 1
\end{bmatrix}$$ \text{Filter}$$<p>Then the convolved feature matrix will be:
<img alt="title" src="http://engineering.flipboard.com/assets/convnets/Convolution_schematic.gif" /></p>
<p>The stride is simply how many pixels we slide our filter matrix over to perform the element wise multiplication and sum. For our example, we used a stride of 1 so notice the filter matrix moves over just one pixel between each operation.</p>
<p>The filter matrix's purpose is to determine distinctive features of the images we are trying to classify such as edges. The filter is learned when we train our model and at each convolution layer, we can apply multiple filters.</p>
<p><strong> Pooling Layer </strong>:
The pooling layer is a way to do non-linear down sampling. Max pooling is the most common type of pooling. The max pooling layer partitions the input matrix into non-overlapping sub-regions in a defined number of strides and computes the max of the sub-region and stores the max into a result matrix. An example of max pooling with stride = 2:</p>
<p><img alt="title" src="https://upload.wikimedia.org/wikipedia/commons/e/e9/Max_pooling.png" /></p>
<p>Sources of images:</p>
<ul>
<li><p><a href="http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution">http://deeplearning.stanford.edu/wiki/index.php/Feature_extraction_using_convolution</a></p>
</li>
<li><p><a href="http://cs231n.github.io/convolutional-networks/">http://cs231n.github.io/convolutional-networks/</a></p>
</li>
</ul>
<p>Both the convolution and pooling layers are ways to not only detect distinctive features in our classes, but they also eliminate the number of parameters in our model. This is a huge deal because using a traditional neural network for image classification can be very costly in terms of the number of parameters required.</p>
<p><strong> Fun fact:</strong> The structure of a convolutional neural network is motivated by the animal visual cortex.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The structure of our network will be:</p>
<p>[Convolution --> Convolution --> Max Pooling --> Convolution --> Convolution --> Max Pooling --> Fully Connected --> Fully Connected --> Output]</p>
<p>At each of our convolution layers, we will apply 64 3x3 filters with stride 1. Our max pooling layer will be a max pooling layer of size 2x2 with stride 2.
The 2 fully connected layers will be like our perceptron model, which will contain 512 neurons each. The output layer will have 10 neurons because we have 10 classes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">weight_var</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="n">initial</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">truncated_normal</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">stddev</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">bias_var</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="n">initial</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">initial</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">conv2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">strides</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">padding</span> <span class="o">=</span> <span class="s1">'SAME'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">max_pool</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">max_pool</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ksize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">strides</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">padding</span> <span class="o">=</span> <span class="s1">'SAME'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x_image</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="c1">#Convolution Layer</span>
<span class="n">W_conv1</span> <span class="o">=</span> <span class="n">weight_var</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">b_conv1</span> <span class="o">=</span> <span class="n">bias_var</span><span class="p">([</span><span class="mi">64</span><span class="p">])</span>
<span class="n">h_conv1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">conv2d</span><span class="p">(</span><span class="n">x_image</span><span class="p">,</span> <span class="n">W_conv1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_conv1</span><span class="p">)</span>

<span class="c1">#Convolution Layer</span>
<span class="n">W_conv2</span> <span class="o">=</span> <span class="n">weight_var</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">b_conv2</span> <span class="o">=</span> <span class="n">bias_var</span><span class="p">([</span><span class="mi">64</span><span class="p">])</span>

<span class="n">h_conv2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">conv2d</span><span class="p">(</span><span class="n">h_conv1</span><span class="p">,</span> <span class="n">W_conv2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_conv2</span><span class="p">)</span>
<span class="c1">#Max Pool Layer</span>
<span class="n">h_pool1</span> <span class="o">=</span> <span class="n">max_pool</span><span class="p">(</span><span class="n">h_conv2</span><span class="p">)</span>


<span class="c1">#Convolution Layer</span>
<span class="n">W_conv3</span> <span class="o">=</span> <span class="n">weight_var</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">b_conv3</span> <span class="o">=</span> <span class="n">bias_var</span><span class="p">([</span><span class="mi">64</span><span class="p">])</span>

<span class="n">h_conv3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">conv2d</span><span class="p">(</span><span class="n">h_pool1</span><span class="p">,</span> <span class="n">W_conv3</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_conv3</span><span class="p">)</span>

<span class="c1">#Convolution Layer</span>
<span class="n">W_conv4</span> <span class="o">=</span> <span class="n">weight_var</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">b_conv4</span> <span class="o">=</span> <span class="n">bias_var</span><span class="p">([</span><span class="mi">64</span><span class="p">])</span>

<span class="n">h_conv4</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">conv2d</span><span class="p">(</span><span class="n">h_conv3</span><span class="p">,</span> <span class="n">W_conv4</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_conv4</span><span class="p">)</span>

<span class="c1">#Max Pool Layer</span>
<span class="n">h_pool2</span> <span class="o">=</span> <span class="n">max_pool</span><span class="p">(</span><span class="n">h_conv4</span><span class="p">)</span>

<span class="c1">#Full Layer</span>
<span class="n">W_fc1</span> <span class="o">=</span> <span class="n">weight_var</span><span class="p">([</span><span class="mi">7</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">512</span><span class="p">])</span>
<span class="n">b_fc1</span> <span class="o">=</span> <span class="n">bias_var</span><span class="p">([</span><span class="mi">512</span><span class="p">])</span>

<span class="n">h_pool2_flat</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">h_pool2</span><span class="p">,[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">64</span><span class="p">])</span>
<span class="n">h_fc1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">h_pool2_flat</span><span class="p">,</span> <span class="n">W_fc1</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_fc1</span><span class="p">)</span>

<span class="c1">#Dropout</span>
<span class="n">keep_prob</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">h_fc1_drop</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">dropout</span><span class="p">(</span><span class="n">h_fc1</span><span class="p">,</span> <span class="n">keep_prob</span><span class="p">)</span>

<span class="c1">#Full Layer</span>
<span class="n">W_fc2</span> <span class="o">=</span> <span class="n">weight_var</span><span class="p">([</span><span class="mi">512</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="n">b_fc2</span> <span class="o">=</span> <span class="n">bias_var</span><span class="p">([</span><span class="mi">10</span><span class="p">])</span>

<span class="n">y_conv</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">h_fc1_drop</span><span class="p">,</span> <span class="n">W_fc2</span><span class="p">)</span> <span class="o">+</span> <span class="n">b_fc2</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For our output layer, we will use the cross entropy function to produce our logits and will use the ADAM stochastic optimization to train our model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cross_entropy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax_cross_entropy_with_logits</span><span class="p">(</span><span class="n">labels</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">logits</span> <span class="o">=</span> <span class="n">y_conv</span><span class="p">))</span>
<span class="n">train_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cross_entropy</span><span class="p">)</span>
<span class="n">correct_pred</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y_conv</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">correct_pred</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">InteractiveSession</span><span class="p">()</span>
<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>
for i in range(20000):
    batch = mnist.train.next_batch(100)
    test_batch = mnist.test.next_batch(100)
    if i % 1000 == 0:
#         train_accuracy = acc.eval(feed_dict = {x:batch[0], y:batch[1], keep_prob: 1.0})
        test_accuracy = acc.eval(feed_dict = {x:test_batch[0], y:test_batch[1], keep_prob: 1.0})
        print('test_accuracy: %g' %(test_accuracy))
    train_step.run(feed_dict = {x: batch[0], y: batch[1], keep_prob: 0.5})
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>test_accuracy: 0.09
test_accuracy: 0.99
test_accuracy: 0.99
test_accuracy: 1
test_accuracy: 1
test_accuracy: 0.99
test_accuracy: 0.99
test_accuracy: 1
test_accuracy: 1
test_accuracy: 0.99
test_accuracy: 1
test_accuracy: 1
test_accuracy: 1
test_accuracy: 1
test_accuracy: 0.99
test_accuracy: 1
test_accuracy: 1
test_accuracy: 1
test_accuracy: 1
test_accuracy: 0.99
Wall time: 5min 4s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_accuracy</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">test_set</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">test_accuracy</span> <span class="o">+=</span> <span class="n">acc</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">feed_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span><span class="n">test_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">:</span><span class="n">test_set</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">keep_prob</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>  
<span class="n">avg_test_acc</span> <span class="o">=</span> <span class="n">test_accuracy</span><span class="o">/</span><span class="mi">100</span> <span class="o">*</span> <span class="mi">100</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'average test accuracy </span><span class="si">%g</span><span class="s1">'</span><span class="o">%</span><span class="k">avg_test_acc</span>)
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>average test accuracy 99.34
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that we get much better results from this model than using the multilayer perceptron network (MLP). The MLP network achieved a 96.7% accuracy while our CNN network best it at 99.34%. Training these two networks have been enjoyable on a GPU. The training times on a GPU vs CPU are drastic. The training for the CNN only took a little more than 5 minutes. While it would take more than 30 mins to train on my quad core Macbook Pro CPU.</p>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ttran0.github.io/tag/python.html">python</a>
    </p>
  </div>


    <div class="addthis_relatedposts_inline">


</article>

    <footer>
<p>&copy; Truong Tran </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-107749625-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->



<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Truong's Website ",
  "url" : "https://ttran0.github.io",
  "image": "https://media.licdn.com/dms/image/C5103AQE-KW5gH0banw/profile-displayphoto-shrink_200_200/0?e=1529121600&v=beta&t=t7WWD9umuS0wPmwZbYJQBMajMvCBZHHWEbQuy67A_1M",
  "description": ""
}
</script>

</body>
</html>
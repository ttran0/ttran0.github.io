
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://ttran0.github.io/theme/font-awesome/css/font-awesome.min.css">


    <link href="https://ttran0.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Truong's Website Atom">



  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />


<meta name="author" content="Truong Tran" />
<meta name="description" content="Multilayer Perceptron¶ So I recently upgraded my desktop and now that I have a gtx 1070 card, I really wanted to get my hands on deep learning using my gpu. The library that I have decided to go with is Tensorflow. Tensorflow is a graph computation/deep learning library developed by Google. Tensorflow also has support for running on the gpu so that we can train larger and faster networks. This notebook will run through will include building a multilayer perceptron model on the classic MNIST dataset." />
<meta name="keywords" content="python">
<meta property="og:site_name" content="Truong's Website"/>
<meta property="og:title" content="Hello World! (Of Tensorflow, GPU Computing, and Deep Learning)"/>
<meta property="og:description" content="Multilayer Perceptron¶ So I recently upgraded my desktop and now that I have a gtx 1070 card, I really wanted to get my hands on deep learning using my gpu. The library that I have decided to go with is Tensorflow. Tensorflow is a graph computation/deep learning library developed by Google. Tensorflow also has support for running on the gpu so that we can train larger and faster networks. This notebook will run through will include building a multilayer perceptron model on the classic MNIST dataset."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ttran0.github.io/Deep-Learning.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2017-02-16 20:11:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://ttran0.github.io/author/truong-tran.html">
<meta property="article:section" content="Projects"/>
<meta property="article:tag" content="python"/>
<meta property="og:image" content="https://media.licdn.com/mpr/mpr/shrinknp_400_400/AAEAAQAAAAAAAAlNAAAAJDUwZmRlZmQ1LWRkYmMtNDA0OC1hMzVkLTQ0NmEzN2E4MjI4MA.jpg">

  <title>Truong's Website &ndash; Hello World! (Of Tensorflow, GPU Computing, and Deep Learning)</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://ttran0.github.io">
        <img src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/AAEAAQAAAAAAAAlNAAAAJDUwZmRlZmQ1LWRkYmMtNDA0OC1hMzVkLTQ0NmEzN2E4MjI4MA.jpg" alt="" title="">
      </a>
      <h1><a href="https://ttran0.github.io"></a></h1>

<p>Mathematician & Aspiring Data Scientist</p>
      <nav>
        <ul class="list">
          <li><a href="https://ttran0.github.io/pages/about-me.html#about-me">About Me</a></li>
          <li><a href="https://ttran0.github.io/pages/contact.html#contact">Contact</a></li>
          <li><a href="https://ttran0.github.io/pages/resume.html#resume">Resume</a></li>

        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/truong-tran" target="_blank"><i class="fa fa-linkedin"></i></a></li>
        <li><a class="sc-github" href="https://github.com/ttran0" target="_blank"><i class="fa fa-github"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://ttran0.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/category/projects.html">Data Science Projects</a>
      <a href="/category/teaching.html">Teaching</a>

      <a href="https://ttran0.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
    <h1 id="Deep-Learning">Hello World! (Of Tensorflow, GPU Computing, and Deep Learning)</h1>
    <p>
          Posted on Thu 16 February 2017 in <a href="https://ttran0.github.io/category/projects.html">Projects</a>


    </p>
  </header>


  <div>
    <style type="text/css">/*!
*
* IPython notebook
*
*/.ansibold{font-weight:700}.ansiblack{}.ansired{color:#8b0000}.ansigreen{6400}.ansiyellow{color:#c4a000}.ansiblue{8b}.ansipurple{color:#9400d3}.ansicyan{color:#4682b4}.ansigray{color:gray}.ansibgblack{background-}.ansibgred{background-color:red}.ansibggreen{background-color:green}.ansibgyellow{background-color:#ff0}.ansibgblue{background-f}.ansibgpurple{background-color:#ff00ff}.ansibgcyan{background-ff}.ansibggray{background-color:gray}div.cell{border:1px solid transparent;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;border-radius:2px;box-sizing:border-box;-moz-box-sizing:border-box;border-width:thin;border-style:solid;width:100%;padding:5px;margin:0;outline:0}div.cell.selected{border-color:#ababab}@media print{div.cell.selected{border-color:transparent}}.edit_mode div.cell.selected{border-color:green}.prompt{min-width:14ex;padding:.4em;margin:0;font-family:monospace;text-align:right;line-height:1.21429em}div.inner_cell{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1}@-moz-document url-prefix(){div.inner_cell{overflow-x:hidden}}div.input_area{border:1px solid #cfcfcf;border-radius:2px;background:#f7f7f7;line-height:1.21429em}div.prompt:empty{padding-top:0;padding-bottom:0}div.unrecognized_cell{padding:5px 5px 5px 0;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.unrecognized_cell .inner_cell{border-radius:2px;padding:5px;font-weight:700;color:red;border:1px solid #cfcfcf;background:#eaeaea}div.unrecognized_cell .inner_cell a,div.unrecognized_cell .inner_cell a:hover{color:inherit;text-decoration:none}@media (max-width:540px){.prompt{text-align:left}div.unrecognized_cell>div.prompt{display:none}}div.code_cell{}div.input{page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.input{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.input_prompt{color:navy;border-top:1px solid transparent}div.input_area>div.highlight{margin:.4em;border:none;padding:0;background-color:transparent}div.input_area>div.highlight>pre{margin:0;border:none;padding:0;background-color:transparent}.CodeMirror{line-height:1.21429em;font-size:14px;height:auto;background:0 0}.CodeMirror-scroll{overflow-y:hidden;overflow-x:auto}.CodeMirror-lines{padding:.4em}.CodeMirror-linenumber{padding:0 8px 0 4px}.CodeMirror-gutters{border-bottom-left-radius:2px;border-top-left-radius:2px}.CodeMirror pre{padding:0;border:0;border-radius:0}.highlight-base,.highlight-variable{}.highlight-variable-2{color:#1a1a1a}.highlight-variable-3{color:#333}.highlight-string{color:#BA2121}.highlight-comment{color:#408080;font-style:italic}.highlight-number{80}.highlight-atom{color:#88F}.highlight-keyword{color:green;font-weight:700}.highlight-builtin{color:green}.highlight-error{color:red}.highlight-operator{color:#A2F;font-weight:700}.highlight-meta{color:#A2F}.highlight-def{f}.highlight-string-2{color:#f50}.highlight-qualifier{color:#555}.highlight-bracket{color:#997}.highlight-tag{color:#170}.highlight-attribute{c}.highlight-header{f}.highlight-quote{90}.highlight-link{c}.cm-s-ipython span.cm-keyword{color:green;font-weight:700}.cm-s-ipython span.cm-atom{color:#88F}.cm-s-ipython span.cm-number{80}.cm-s-ipython span.cm-def{f}.cm-s-ipython span.cm-variable{}.cm-s-ipython span.cm-operator{color:#A2F;font-weight:700}.cm-s-ipython span.cm-variable-2{color:#1a1a1a}.cm-s-ipython span.cm-variable-3{color:#333}.cm-s-ipython span.cm-comment{color:#408080;font-style:italic}.cm-s-ipython span.cm-string{color:#BA2121}.cm-s-ipython span.cm-string-2{color:#f50}.cm-s-ipython span.cm-meta{color:#A2F}.cm-s-ipython span.cm-qualifier{color:#555}.cm-s-ipython span.cm-builtin{color:green}.cm-s-ipython span.cm-bracket{color:#997}.cm-s-ipython span.cm-tag{color:#170}.cm-s-ipython span.cm-attribute{c}.cm-s-ipython span.cm-header{f}.cm-s-ipython span.cm-quote{90}.cm-s-ipython span.cm-link{c}.cm-s-ipython span.cm-error{color:red}.cm-s-ipython span.cm-tab{background:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=')right no-repeat}div.output_wrapper{display:-webkit-box;-webkit-box-align:stretch;display:-moz-box;-moz-box-align:stretch;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch;z-index:1}div.output_scroll{height:24em;width:100%;overflow:auto;border-radius:2px;-webkit-box-shadow:inset 0 2px 8px rgba(0,0,0,.8);box-shadow:inset 0 2px 8px rgba(0,0,0,.8);display:block}div.output_collapsed{margin:0;padding:0;display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}div.out_prompt_overlay{height:100%;padding:0 .4em;position:absolute;border-radius:2px}div.out_prompt_overlay:hover{-webkit-box-shadow:inset 0 0 1px #000;box-shadow:inset 0 0 1px #000;background:rgba(240,240,240,.5)}div.output_prompt{color:#8b0000}div.output_area{padding:0;page-break-inside:avoid;display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}div.output_area .MathJax_Display{text-align:left!important}div.output_area div.output_area img,div.output_area svg{max-width:100%;height:auto}div.output_area img.unconfined,div.output_area svg.unconfined{max-width:none}.output{display:-webkit-box;-webkit-box-orient:vertical;display:-moz-box;-moz-box-orient:vertical;display:box;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}@media (max-width:540px){div.output_area{-webkit-box-orient:vertical;-moz-box-orient:vertical;box-orient:vertical;box-align:stretch;display:flex;flex-direction:column;align-items:stretch}}div.output_area pre{margin:0;padding:0;border:0;vertical-align:baseline;background-color:transparent;border-radius:0}div.output_subarea{overflow-x:auto;padding:.4em;-webkit-box-flex:1;-moz-box-flex:1;box-flex:1;flex:1;max-width:calc(100% - 14ex)}div.output_text{text-align:left;line-height:1.21429em}div.output_stderr{background:#fdd}div.output_latex{text-align:left}div.output_javascript:empty{padding:0}.js-error{color:#8b0000}div.raw_input_container{font-family:monospace;padding-top:5px}span.raw_input_prompt{}input.raw_input{font-family:inherit;font-size:inherit;color:inherit;width:auto;vertical-align:baseline;padding:0 .25em;margin:0 .25em}input.raw_input:focus{box-shadow:none}p.p-space{margin-bottom:10px}div.output_unrecognized{padding:5px;font-weight:700;color:red}div.output_unrecognized a,div.output_unrecognized a:hover{color:inherit;text-decoration:none}.rendered_html{}.rendered_html :link,.rendered_html :visited,.rendered_html h1:first-child{margin-top:.538em}.rendered_html h2:first-child{margin-top:.636em}.rendered_html h3:first-child{margin-top:.777em}.rendered_html h4:first-child,.rendered_html h5:first-child,.rendered_html h6:first-child{margin-top:1em}.rendered_html *+ol,.rendered_html *+ul{margin-top:1em}.rendered_html *+table{margin-top:1em}.rendered_html *+p{margin-top:1em}.rendered_html *+img{margin-top:1em}div.text_cell{display:-webkit-box;-webkit-box-orient:horizontal;display:-moz-box;-moz-box-orient:horizontal;display:box;box-orient:horizontal;box-align:stretch;display:flex;flex-direction:row;align-items:stretch}@media (max-width:540px){div.text_cell>div.prompt{display:none}}div.text_cell_render{outline:0;resize:none;width:inherit;border-style:none;padding:.5em .5em .5em .4em;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box}a.anchor-link:link{text-decoration:none;padding:0 20px;visibility:hidden}h1:hover .anchor-link,h2:hover .anchor-link,h3:hover .anchor-link,h4:hover .anchor-link,h5:hover .anchor-link,h6:hover .anchor-link{visibility:visible}.text_cell.rendered .input_area{display:none}.text_cell.rendered .text_cell.unrendered .text_cell_render{display:none}.cm-header-1,.cm-header-2,.cm-header-3,.cm-header-4,.cm-header-5,.cm-header-6{font-weight:700;font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}.cm-header-1{font-size:185.7%}.cm-header-2{font-size:157.1%}.cm-header-3{font-size:128.6%}.cm-header-4{font-size:110%}.cm-header-5,.cm-header-6{font-size:100%;font-style:italic}</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Multilayer-Perceptron">Multilayer Perceptron<a class="anchor-link" href="#Multilayer-Perceptron">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So I recently upgraded my desktop and now that I have a gtx 1070 card, I really wanted to get my hands on deep learning using my gpu. The library that I have decided to go with is Tensorflow. Tensorflow is a graph computation/deep learning library developed by Google. Tensorflow also has support for running on the gpu so that we can train larger and faster networks. This notebook will run through will include building a multilayer perceptron model on the classic MNIST dataset.</p>
<p>The MNIST dataset includes samples of handwritten digits from 1 - 10. The objective is to train our network so that it can determine the digit in a given image.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="kn">from</span> <span class="nn">tensorflow.examples.tutorials.mnist</span> <span class="kn">import</span> <span class="n">input_data</span>
<span class="n">mnist</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="s2">"/tmp/data/"</span><span class="p">,</span> <span class="n">one_hot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Extracting /tmp/data/train-images-idx3-ubyte.gz
Extracting /tmp/data/train-labels-idx1-ubyte.gz
Extracting /tmp/data/t10k-images-idx3-ubyte.gz
Extracting /tmp/data/t10k-labels-idx1-ubyte.gz
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some examples of what each image looks like in the MNIST dataset:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [83]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[83]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.image.axesimage at 0x203e068ec50></pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
QRF+ICjG+YEJhHF+ABURfiAowg8ERfiBoAg/EBThB4Ii/EBQFcNvZnPM7AdmtsPMtpvZH2XLbzez
A2a2JftZ2vh2ARTlpCrWGZJ0i7tvNrPpkjaZ2dNZ7R53v7Nx7QFolIrhd/eDkg5mj4+a2U5Jsxvd
GIDGel+f+c1srqQLJG3MFt1kZlvNbI2ZjXs/KDNbaWb9ZtZ/QoN1NQugOFWH38xOlfSQpJvd/Yik
+ySdI2mBRt8Z3DXedu6+yt173L2nU1MKaBlAEaoKv5l1ajT4D7j7w5Lk7ofcfdjdRyR9Q9LCxrUJ
oGjVnO03Sasl7XT3u8cs7x6z2jWSthXfHoBGqeZs/4WSPiXpBTPbki27TVKvmS2Q5JL2SvpMQzoE
0BDVnO1/VtJ41wc/UXw7AJqFb/gBQRF+ICjCDwRF+IGgCD8QFOEHgiL8QFCEHwiK8ANBEX4gKMIP
BEX4gaAIPxAU4QeCauoU3Wb2qqR9YxZ9SNJPm9bA+9OqvbVqXxK91arI3s5y99OrWbGp4X/Pzs36
3b2ntAYSWrW3Vu1LordaldUbb/uBoAg/EFTZ4V9V8v5TWrW3Vu1LordaldJbqZ/5AZSn7CM/gJKU
En4zW2JmL5rZHjO7tYwe8pjZXjN7IZt5uL/kXtaY2WEz2zZm2Swze9rMdme/x50mraTeWmLm5sTM
0qW+dq0243XT3/abWYekXZIul7Rf0vOSet19R1MbyWFmeyX1uHvpY8Jm9jFJb0i6393Pz5b9jaQB
d78j+49zprv/aYv0drukN8qeuTmbUKZ77MzSkq6WdL1KfO0SfS1XCa9bGUf+hZL2uPtL7n5c0nck
LSuhj5bn7hskDbxr8TJJa7PHazX6j6fpcnprCe5+0N03Z4+PSnp7ZulSX7tEX6UoI/yzJb085u/9
aq0pv13SM2a2ycxWlt3MOLqyadMl6RVJXWU2M46KMzc307tmlm6Z166WGa+Lxgm/97rI3RdIukLS
jdnb25bko5/ZWmm4pqqZm5tlnJmlf67M167WGa+LVkb4D0iaM+bvM7NlLcHdD2S/D0t6RK03+/Ch
tydJzX4fLrmfn2ulmZvHm1laLfDatdKM12WE/3lJ88zsbDObLOk6SetL6OM9zGxadiJGZjZN0sfV
erMPr5e0Inu8QtKjJfbyDq0yc3PezNIq+bVruRmv3b3pP5KWavSM//9I+kIZPeT0dY6k/85+tpfd
m6QHNfo28IRGz43cIOmDkvok7Zb0jKRZLdTbtyS9IGmrRoPWXVJvF2n0Lf1WSVuyn6Vlv3aJvkp5
3fiGHxAUJ/yAoAg/EBThB4Ii/EBQhB8IivADQRF+ICjCDwT1/yYYdtH5eFIaAAAAAElFTkSuQmCC
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [85]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">28</span><span class="p">,</span><span class="mi">28</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt output_prompt">Out[85]:</div>
<div class="output_text output_subarea output_execute_result">
<pre><matplotlib.image.axesimage at 0x203e06e63c8></pre>
</div>
</div>
<div class="output_area"><div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
">
</img></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A multilayer perceptron model consists of an input layer, a hidden layer (or multiple hidden layers), and an output layer.</p>
<p><img src="https://upload.wikimedia.org/wikipedia/commons/c/c2/MultiLayerNeuralNetworkBigger_english.png" style="width: 550px" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our model will contain 3 hidden layers with the rectified linear unit (ReLU) function as our activation function. The ReLU function is defined as:
$$
f(x) = 
\begin{cases} 
      1 & x > 0 \\
      0 & otherwise
   \end{cases}
$$</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [76]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s2">"float"</span><span class="p">,</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="n">n</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="s2">"float"</span><span class="p">,</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define model:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [77]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="k">def</span> <span class="nf">mlp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bias</span><span class="p">):</span>
    <span class="c1"># Hidden Layer 1</span>
    <span class="n">layer1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'h1'</span><span class="p">]),</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'b1'</span><span class="p">])</span>
    <span class="n">layer1</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer1</span><span class="p">)</span>
    
    <span class="c1"># Hidden Layer 2 </span>
    <span class="n">layer2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">layer1</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'h2'</span><span class="p">]),</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'b2'</span><span class="p">])</span>
    <span class="n">layer2</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer2</span><span class="p">)</span>
    
    <span class="c1"># Hidden Layer 3 </span>
    <span class="n">layer3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">layer2</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'h3'</span><span class="p">]),</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'b3'</span><span class="p">])</span>
    <span class="n">layer3</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">layer3</span><span class="p">)</span>
    
    <span class="c1"># Output Layer </span>
    <span class="n">output_layer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">layer3</span><span class="p">,</span> <span class="n">weights</span><span class="p">[</span><span class="s1">'out'</span><span class="p">])</span> <span class="o">+</span> <span class="n">biases</span><span class="p">[</span><span class="s1">'out'</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">output_layer</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define our weights and biases:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [90]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="c1"># Define weights and biases</span>
<span class="n">n_hidden1</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">n_hidden2</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">n_hidden3</span> <span class="o">=</span> <span class="mi">256</span>

<span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'h1'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n</span><span class="p">,</span> <span class="n">n_hidden1</span><span class="p">])),</span> 
    <span class="s1">'h2'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden1</span><span class="p">,</span> <span class="n">n_hidden2</span><span class="p">])),</span>
    <span class="s1">'h3'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden2</span><span class="p">,</span> <span class="n">n_hidden3</span><span class="p">])),</span>
    <span class="s1">'out'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden3</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">]))</span>
<span class="p">}</span>

<span class="n">biases</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'b1'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden1</span><span class="p">])),</span> 
    <span class="s1">'b2'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden2</span><span class="p">])),</span> 
    <span class="s1">'b3'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">n_hidden3</span><span class="p">])),</span>
    <span class="s1">'out'</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">random_normal</span><span class="p">([</span><span class="n">num_classes</span><span class="p">]))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [97]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">training_epochs</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">mlp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">biases</span><span class="p">)</span>
<span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax_cross_entropy_with_logits</span><span class="p">(</span><span class="n">logits</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">y</span><span class="p">))</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will use the stochastic gradient optimization algorithm to optimize our weights and biases with batch size 100. The stochastic gradient descent will randomly sample 100 of the images in our training set and train our model using 50 epochs to update our weights (1 pass forward in the network, and 1 pass backwards using backpropagation). The data has already been split into a training and testing set as part of a built in feature in Tensorflow. We just need to train our model and determine its accuracy by comparing it to the test set.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [101]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython2"><pre><span></span><span class="n">init</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>

<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
    <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">init</span><span class="p">)</span>

    
    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">training_epochs</span><span class="p">):</span>
        <span class="n">avg_cost</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="n">total_batch</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">num_examples</span><span class="o">/</span><span class="n">batch_size</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">total_batch</span><span class="p">):</span>
            
            <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
                        
            <span class="n">_</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">optimizer</span><span class="p">,</span> <span class="n">cost</span><span class="p">],</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">batch_x</span><span class="p">,</span>
                                                          <span class="n">y</span><span class="p">:</span> <span class="n">batch_y</span><span class="p">})</span>
            
            <span class="n">avg_cost</span> <span class="o">+=</span> <span class="n">c</span> <span class="o">/</span> <span class="n">total_batch</span>

        <span class="k">print</span> <span class="p">(</span><span class="s2">"Epoch:"</span><span class="p">,</span> <span class="s1">'</span><span class="si">%0d</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="s2">"cost="</span><span class="p">,</span> <span class="s2">"{:.3f}"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">avg_cost</span><span class="p">))</span>

    
    <span class="n">pred</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="s2">"float"</span><span class="p">))</span>
    <span class="k">print</span> <span class="p">(</span><span class="s2">"Accuracy:"</span><span class="p">,</span> <span class="n">acc</span><span class="o">.</span><span class="n">eval</span><span class="p">({</span><span class="n">x</span><span class="p">:</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">images</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">mnist</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">labels</span><span class="p">})</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area"><div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Epoch: 1 cost= 936.272
Epoch: 2 cost= 216.633
Epoch: 3 cost= 146.919
Epoch: 4 cost= 103.030
Epoch: 5 cost= 82.060
Epoch: 6 cost= 66.410
Epoch: 7 cost= 58.126
Epoch: 8 cost= 47.596
Epoch: 9 cost= 41.920
Epoch: 10 cost= 35.643
Epoch: 11 cost= 31.135
Epoch: 12 cost= 27.851
Epoch: 13 cost= 25.317
Epoch: 14 cost= 21.935
Epoch: 15 cost= 20.035
Epoch: 16 cost= 18.263
Epoch: 17 cost= 16.363
Epoch: 18 cost= 14.673
Epoch: 19 cost= 12.848
Epoch: 20 cost= 11.297
Epoch: 21 cost= 11.236
Epoch: 22 cost= 9.495
Epoch: 23 cost= 9.143
Epoch: 24 cost= 8.317
Epoch: 25 cost= 7.601
Epoch: 26 cost= 6.615
Epoch: 27 cost= 6.030
Epoch: 28 cost= 5.580
Epoch: 29 cost= 5.029
Epoch: 30 cost= 4.679
Epoch: 31 cost= 4.614
Epoch: 32 cost= 3.817
Epoch: 33 cost= 3.542
Epoch: 34 cost= 2.902
Epoch: 35 cost= 3.418
Epoch: 36 cost= 2.386
Epoch: 37 cost= 2.389
Epoch: 38 cost= 2.204
Epoch: 39 cost= 2.047
Epoch: 40 cost= 2.045
Epoch: 41 cost= 1.595
Epoch: 42 cost= 1.463
Epoch: 43 cost= 1.447
Epoch: 44 cost= 0.991
Epoch: 45 cost= 1.069
Epoch: 46 cost= 1.001
Epoch: 47 cost= 0.912
Epoch: 48 cost= 0.749
Epoch: 49 cost= 0.737
Epoch: 50 cost= 0.556
Accuracy: 91.1700129509
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With 50 epochs, a 3 hidden layer multilayer perceptron optimized with stochastic gradient descent, we achieve a 91% accuracy. This accuracy is actually not that great compared to what other models can do. One way to improve on this model is introduce convolution and pooling layers, more commonly known as a convolutional neural network, which is what I will be working on next to get a better accuracy.</p>
</div>
</div>
</div>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ttran0.github.io/tag/python.html">python</a>
    </p>
  </div>




</article>

    <footer>
<p>&copy; Truong Tran </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>





<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Truong's Website ",
  "url" : "https://ttran0.github.io",
  "image": "https://media.licdn.com/mpr/mpr/shrinknp_400_400/AAEAAQAAAAAAAAlNAAAAJDUwZmRlZmQ1LWRkYmMtNDA0OC1hMzVkLTQ0NmEzN2E4MjI4MA.jpg",
  "description": ""
}
</script>
</body>
</html>